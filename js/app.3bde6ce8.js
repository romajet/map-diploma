(function(){"use strict";var e={8087:function(e,t,n){var o=n(3751),l=n(641);const i={id:"app"};function r(e,t,n,o,r,s){const a=(0,l.g2)("BuildingList"),u=(0,l.g2)("ClassroomTable");return(0,l.uX)(),(0,l.CE)("div",i,[t[0]||(t[0]=(0,l.Lk)("h1",null,"Список корпусов",-1)),(0,l.bF)(a,{onBuildingSelected:s.handleBuildingSelected},null,8,["onBuildingSelected"]),r.selectedBuilding?((0,l.uX)(),(0,l.Wv)(u,{key:0,"building-id":r.selectedBuilding},null,8,["building-id"])):(0,l.Q3)("",!0)])}var s=n(33);const a={class:"Building-list"},u=["onClick"];function d(e,t,n,o,i,r){return(0,l.uX)(),(0,l.CE)("div",a,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.buildings,(e=>((0,l.uX)(),(0,l.CE)("button",{key:e.id,onClick:t=>r.selectBuilding(e.id),class:"building-button"},(0,s.v_)(e.name),9,u)))),128))])}var c=n(4335);const m=c.A.create({baseURL:"https://mapapi.susu.ru/integration/map",headers:{"Content-Type":"application/xml",Accept:"application/xml"},responseType:"text"});var f=m,g={name:"buildingList",data(){return{buildings:[]}},async created(){await this.fetchBuildings()},methods:{async fetchBuildings(){try{const e=await f.get("/buildings",{responseType:"text"}),t=new DOMParser,n=t.parseFromString(e.data,"application/xml"),o=n.getElementsByTagName("Building");this.buildings=Array.from(o).map((e=>({id:e.getElementsByTagName("Id")[0].textContent,name:e.getElementsByTagName("Name")[0].textContent})))}catch(e){console.error("ошибка при загрузке корпусов: ",e)}},selectBuilding(e){this.$emit("building-selected",e)}}},p=n(6262);const h=(0,p.A)(g,[["render",d],["__scopeId","data-v-8ab90674"]]);var b=h;const y={class:"classroom-table"},v={class:"filter"},C=["value"],B={key:0},k={key:1};function x(e,t,n,i,r,a){return(0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("h2",null,"Аудитории корпуса "+(0,s.v_)(r.buildingName),1),(0,l.Lk)("div",v,[t[3]||(t[3]=(0,l.Lk)("label",{for:"floor-select"},"Выберите этаж:",-1)),(0,l.bo)((0,l.Lk)("select",{id:"floor-select","onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedFloor=e),onChange:t[1]||(t[1]=(...e)=>a.filterClassrooms&&a.filterClassrooms(...e))},[t[2]||(t[2]=(0,l.Lk)("option",{value:""},"Все этажи",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.floors,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e,value:e}," Этаж "+(0,s.v_)(e),9,C)))),128))],544),[[o.u1,r.selectedFloor]])]),r.filteredClassrooms.length?((0,l.uX)(),(0,l.CE)("table",B,[t[4]||(t[4]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"#"),(0,l.Lk)("th",null,"Название аудитории"),(0,l.Lk)("th",null,"Этаж")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredClassrooms,((e,t)=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id},[(0,l.Lk)("td",null,(0,s.v_)(t+1),1),(0,l.Lk)("td",null,(0,s.v_)(e.name),1),(0,l.Lk)("td",null,(0,s.v_)(e.floor),1)])))),128))])])):((0,l.uX)(),(0,l.CE)("p",k,"Нет аудиторий для отображения"))])}n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var E={name:"ClassroomTable",props:{buildingId:{type:Number,required:!0}},data(){return{classrooms:[],filteredClassrooms:[],floors:[],selectedFloor:"",buildingName:""}},created(){this.fetchClassrooms(),this.fetchBuildingName()},methods:{async fetchClassrooms(){try{const e=await f.get("/rooms/buildingId/${this.buildingId}",{responseType:"text"}),t=new DOMParser,n=t.parseFromString(e.data,"application/xml"),o=n.getElementsByTagName("Room");this.classrooms=Array.from(o).map((e=>({id:e.getElementsByTagName("Id")[0].textContent,name:e.getElementsByTagName("Name")[0].textContent,floor:e.getElementsByTagName("Floor")[0].textContent}))),this.filteredClassrooms=this.classrooms,this.extractFloors()}catch(e){console.error("ошибка при загрузке аудиторий:",e)}},extractFloors(){const e=new Set(this.classrooms.map((e=>e.floor)));this.floors=Array.from(e).sort(((e,t)=>e-t))},filterClassrooms(){this.selectedFloor?this.filteredClassrooms=this.classrooms.filter((e=>e.floor===this.selectedFloor)):this.filteredClassrooms=this.classrooms},async fetchBuildingName(){try{const e=await f.get("/buildings",{responseType:"text"}),t=new DOMParser,n=t.parseFromString(e.data,"application/xml"),o=n.getElementsByTagName("Building"),l=Array.from(o).find((e=>e.getElementsByTagName("Id")[0].textContent===this.buildingId));l?this.buildingName=l.getElementsByTagName("Name")[0].textContent:console.warn("Корпус не найден.")}catch(e){console.error("ошибка при получении названия корпуса: ",e)}}},watch:{buildingId(e,t){e!==t&&(this.fetchClassrooms(),this.fetchBuildingName())}}};const T=(0,p.A)(E,[["render",x],["__scopeId","data-v-5a96d922"]]);var N=T,L={name:"App",components:{BuildingList:b,ClassroomTable:N},data(){return{selectedBuilding:null}},methods:{handleBuildingSelected(e){this.selectedBuilding=e}}};const w=(0,p.A)(L,[["render",r]]);var F=w;(0,o.Ef)(F).mount("#app")}},t={};function n(o){var l=t[o];if(void 0!==l)return l.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,o,l,i){if(!o){var r=1/0;for(d=0;d<e.length;d++){o=e[d][0],l=e[d][1],i=e[d][2];for(var s=!0,a=0;a<o.length;a++)(!1&i||r>=i)&&Object.keys(n.O).every((function(e){return n.O[e](o[a])}))?o.splice(a--,1):(s=!1,i<r&&(r=i));if(s){e.splice(d--,1);var u=l();void 0!==u&&(t=u)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[o,l,i]}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var l,i,r=o[0],s=o[1],a=o[2],u=0;if(r.some((function(t){return 0!==e[t]}))){for(l in s)n.o(s,l)&&(n.m[l]=s[l]);if(a)var d=a(n)}for(t&&t(o);u<r.length;u++)i=r[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(8087)}));o=n.O(o)})();
//# sourceMappingURL=app.3bde6ce8.js.map
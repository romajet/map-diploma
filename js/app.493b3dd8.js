(function(){"use strict";var e={7817:function(e,t,n){var o=n(3751),r=n(641);const s={id:"app"};function l(e,t,n,o,l,i){const a=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.bF)(a)])}var i={name:"App"},a=n(6262);const u=(0,a.A)(i,[["render",l]]);var c=u,d=n(5220);function m(e,t,n,o,s,l){const i=(0,r.g2)("BuildingList");return(0,r.uX)(),(0,r.CE)("div",null,[t[0]||(t[0]=(0,r.Lk)("h1",null,"Выбрите корпус",-1)),(0,r.bF)(i,{onBuildingSelected:l.goToClassroomTable},null,8,["onBuildingSelected"])])}n(4114);var g=n(33);const f={class:"Building-list"},p=["onClick"];function h(e,t,n,o,s,l){return(0,r.uX)(),(0,r.CE)("div",f,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.buildings,(e=>((0,r.uX)(),(0,r.CE)("button",{key:e.id,onClick:t=>l.selectBuilding(e.id),class:"building-button"},(0,g.v_)(e.name),9,p)))),128))])}var b=n(4335);const v=b.A.create({baseURL:"https://mapapi.susu.ru/integration/map",headers:{"Content-Type":"application/xml",Accept:"application/xml"},responseType:"text"});var y=v,C={name:"buildingList",data(){return{buildings:[]}},async created(){await this.fetchBuildings()},methods:{async fetchBuildings(){try{const e=await y.get("/buildings",{responseType:"text"}),t=new DOMParser,n=t.parseFromString(e.data,"application/xml"),o=n.getElementsByTagName("Building");this.buildings=Array.from(o).map((e=>({id:e.getElementsByTagName("Id")[0].textContent,name:e.getElementsByTagName("Name")[0].textContent})))}catch(e){console.error("ошибка при загрузке корпусов: ",e)}},selectBuilding(e){console.log("выбран корпус",e),this.$emit("building-selected",e)}}};const T=(0,a.A)(C,[["render",h],["__scopeId","data-v-4598f7e0"]]);var k=T,B={name:"BuildingListView",components:{BuildingList:k},methods:{goToClassroomTable(e){console.log("переход к аудиториям корпуса:",e),this.$router.push({name:"ClassroomTable",params:{id:e}})}}};const E=(0,a.A)(B,[["render",m]]);var x=E;function L(e,t,n,o,s,l){const i=(0,r.g2)("ClassroomTable");return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.bF)(i,{"building-id":l.buildingId},null,8,["building-id"])])}const w={class:"classroom-table"},N={class:"filter"},F=["value"],O={key:0},I={key:1};function S(e,t,n,s,l,i){return(0,r.uX)(),(0,r.CE)("div",w,[(0,r.Lk)("h2",null,"Аудитории корпуса "+(0,g.v_)(l.buildingName),1),(0,r.Lk)("div",N,[t[3]||(t[3]=(0,r.Lk)("label",{for:"floor-select"},"Выберите этаж:",-1)),(0,r.bo)((0,r.Lk)("select",{id:"floor-select","onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedFloor=e),onChange:t[1]||(t[1]=(...e)=>i.filterClassrooms&&i.filterClassrooms(...e))},[t[2]||(t[2]=(0,r.Lk)("option",{value:""},"Все этажи",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.floors,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e}," Этаж "+(0,g.v_)(e),9,F)))),128))],544),[[o.u1,l.selectedFloor]])]),l.filteredClassrooms.length?((0,r.uX)(),(0,r.CE)("table",O,[t[4]||(t[4]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"#"),(0,r.Lk)("th",null,"Номер"),(0,r.Lk)("th",null,"Название аудитории"),(0,r.Lk)("th",null,"Этаж")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.filteredClassrooms,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,g.v_)(t+1),1),(0,r.Lk)("td",null,(0,g.v_)(e.number),1),(0,r.Lk)("td",null,(0,g.v_)(e.name),1),(0,r.Lk)("td",null,(0,g.v_)(e.floor),1)])))),128))])])):((0,r.uX)(),(0,r.CE)("p",I,"Нет аудиторий для отображения"))])}n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var X={name:"ClassroomTable",props:{buildingId:{type:String,required:!0}},data(){return{classrooms:[],filteredClassrooms:[],floors:[],selectedFloor:"",buildingName:""}},async created(){await Promise.all([this.fetchClassrooms(),this.fetchBuildingName()])},methods:{async fetchClassrooms(){try{const e=await y.get(`/rooms/buildingId/${this.buildingId}`,{responseType:"text"}),t=new DOMParser,n=t.parseFromString(e.data,"application/xml"),o=n.getElementsByTagName("Room");this.classrooms=Array.from(o).map((e=>({id:e.getElementsByTagName("Id")[0].textContent,name:e.getElementsByTagName("Name")[0].textContent,floor:e.getElementsByTagName("Floor")[0].textContent,number:e.getElementsByTagName("Number")[0].textContent}))),this.filteredClassrooms=this.classrooms,this.extractFloors()}catch(e){console.error("ошибка при загрузке аудиторий:",e)}},extractFloors(){const e=new Set(this.classrooms.map((e=>e.floor)));this.floors=Array.from(e).sort(((e,t)=>e-t))},filterClassrooms(){this.selectedFloor?this.filteredClassrooms=this.classrooms.filter((e=>e.floor===this.selectedFloor)):this.filteredClassrooms=this.classrooms},async fetchBuildingName(){try{const e=await y.get("/buildings",{responseType:"text"}),t=new DOMParser,n=t.parseFromString(e.data,"application/xml"),o=n.getElementsByTagName("Building"),r=Array.from(o).find((e=>e.getElementsByTagName("Id")[0].textContent===this.buildingId));r?this.buildingName=r.getElementsByTagName("Name")[0].textContent:console.warn("Корпус не найден.")}catch(e){console.error("ошибка при получении названия корпуса: ",e)}}},watch:{buildingId(e,t){e!==t&&(this.fetchClassrooms(),this.fetchBuildingName())}}};const _=(0,a.A)(X,[["render",S],["__scopeId","data-v-75a402cf"]]);var A=_,j={name:"ClassroomTableView",components:{ClassroomTable:A},props:{id:{type:String,required:!0}},computed:{buildingId(){return this.id}}};const P=(0,a.A)(j,[["render",L]]);var M=P;const D=[{path:"/",name:"BuildingList",component:x},{path:"/building/:id",name:"ClassroomTable",component:M,props:!0}],K=(0,d.aE)({history:(0,d.Bt)(),routes:D});var V=K;(0,o.Ef)(c).use(V).mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,s){if(!o){var l=1/0;for(c=0;c<e.length;c++){o=e[c][0],r=e[c][1],s=e[c][2];for(var i=!0,a=0;a<o.length;a++)(!1&s||l>=s)&&Object.keys(n.O).every((function(e){return n.O[e](o[a])}))?o.splice(a--,1):(i=!1,s<l&&(l=s));if(i){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[o,r,s]}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,s,l=o[0],i=o[1],a=o[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(a)var c=a(n)}for(t&&t(o);u<l.length;u++)s=l[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(c)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(7817)}));o=n.O(o)})();
//# sourceMappingURL=app.493b3dd8.js.map
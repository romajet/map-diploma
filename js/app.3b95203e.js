(function(){"use strict";var e={4649:function(e,t,o){var n=o(3751),r=o(641);const l={id:"app"};function s(e,t,o,n,s,i){const a=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.bF)(a)])}var i={name:"App"},a=o(6262);const u=(0,a.A)(i,[["render",s]]);var d=u,c=o(5220);function m(e,t,o,n,l,s){const i=(0,r.g2)("BuildingList");return(0,r.uX)(),(0,r.CE)("div",null,[t[0]||(t[0]=(0,r.Lk)("h1",null,"Выбрите корпус",-1)),(0,r.bF)(i,{onBuildingSelected:s.goToClassroomTable},null,8,["onBuildingSelected"])])}o(4114);var f=o(33);const g={class:"Building-list"},p=["onClick"];function h(e,t,o,n,l,s){return(0,r.uX)(),(0,r.CE)("div",g,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.buildings,(e=>((0,r.uX)(),(0,r.CE)("button",{key:e.id,onClick:t=>s.selectBuilding(e.id),class:"building-button"},(0,f.v_)(e.name),9,p)))),128))])}var b=o(4335);const y=b.A.create({baseURL:"https://mapapi.susu.ru/integration/map",headers:{"Content-Type":"application/xml",Accept:"application/xml"},responseType:"text"});var v=y,C={name:"buildingList",data(){return{buildings:[]}},async created(){await this.fetchBuildings()},methods:{async fetchBuildings(){try{const e=await v.get("/buildings",{responseType:"text"}),t=new DOMParser,o=t.parseFromString(e.data,"application/xml"),n=o.getElementsByTagName("Building");this.buildings=Array.from(n).map((e=>({id:e.getElementsByTagName("Id")[0].textContent,name:e.getElementsByTagName("Name")[0].textContent})))}catch(e){console.error("ошибка при загрузке корпусов: ",e)}},selectBuilding(e){console.log("выбран корпус",e),this.$emit("building-selected",e)}}};const T=(0,a.A)(C,[["render",h],["__scopeId","data-v-4598f7e0"]]);var k=T,F={name:"BuildingListView",components:{BuildingList:k},methods:{goToClassroomTable(e){console.log("переход к аудиториям корпуса:",e),this.$router.push({name:"ClassroomTable",params:{id:e}})}}};const B=(0,a.A)(F,[["render",m]]);var E=B;function x(e,t,o,n,l,s){const i=(0,r.g2)("ClassroomTable");return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.bF)(i,{"building-id":s.buildingId},null,8,["building-id"])])}const L={class:"classroom-table"},w={class:"filter"},N=["value"],I={key:0},O={key:1};function S(e,t,o,l,s,i){return(0,r.uX)(),(0,r.CE)("div",L,[(0,r.Lk)("h2",null,"Аудитории корпуса "+(0,f.v_)(s.buildingName),1),(0,r.Lk)("div",w,[t[3]||(t[3]=(0,r.Lk)("label",{for:"floor-select"},"Выберите этаж:",-1)),(0,r.bo)((0,r.Lk)("select",{id:"floor-select","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedFloor=e),onChange:t[1]||(t[1]=(...e)=>i.updateFloorQuery&&i.updateFloorQuery(...e))},[t[2]||(t[2]=(0,r.Lk)("option",{value:"all"},"Все этажи",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.floors,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e}," Этаж "+(0,f.v_)(e),9,N)))),128))],544),[[n.u1,s.selectedFloor]])]),s.filteredClassrooms.length?((0,r.uX)(),(0,r.CE)("table",I,[t[4]||(t[4]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"#"),(0,r.Lk)("th",null,"Номер"),(0,r.Lk)("th",null,"Название аудитории"),(0,r.Lk)("th",null,"Этаж")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.filteredClassrooms,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,f.v_)(t+1),1),(0,r.Lk)("td",null,(0,f.v_)(e.number),1),(0,r.Lk)("td",null,(0,f.v_)(e.name),1),(0,r.Lk)("td",null,(0,f.v_)(e.floor),1)])))),128))])])):((0,r.uX)(),(0,r.CE)("p",O,"Нет аудиторий для отображения"))])}o(7642),o(8004),o(3853),o(5876),o(2475),o(5024),o(1698);var X={name:"ClassroomTable",props:{buildingId:{type:String,required:!0}},data(){return{classrooms:[],filteredClassrooms:[],floors:[],selectedFloor:"all",buildingName:""}},async created(){await Promise.all([this.fetchClassrooms(),this.fetchBuildingName()]),this.setInitialFloorFromQuery()},methods:{async fetchClassrooms(){try{const e=await v.get(`/rooms/buildingId/${this.buildingId}`,{responseType:"text"}),t=new DOMParser,o=t.parseFromString(e.data,"application/xml"),n=o.getElementsByTagName("Room");this.classrooms=Array.from(n).map((e=>({id:e.getElementsByTagName("Id")[0].textContent,name:e.getElementsByTagName("Name")[0].textContent,floor:e.getElementsByTagName("Floor")[0].textContent,number:e.getElementsByTagName("Number")[0].textContent}))),this.filteredClassrooms=this.classrooms,this.extractFloors()}catch(e){console.error("ошибка при загрузке аудиторий:",e)}},async fetchBuildingName(){try{const e=await v.get("/buildings",{responseType:"text"}),t=new DOMParser,o=t.parseFromString(e.data,"application/xml"),n=o.getElementsByTagName("Building"),r=Array.from(n).find((e=>e.getElementsByTagName("Id")[0].textContent===this.buildingId));r?this.buildingName=r.getElementsByTagName("Name")[0].textContent:console.warn("Корпус не найден.")}catch(e){console.error("ошибка при получении названия корпуса: ",e)}},extractFloors(){const e=new Set(this.classrooms.map((e=>e.floor)));this.floors=Array.from(e).sort(((e,t)=>e-t))},filterClassrooms(){"all"===this.selectedFloor?this.filteredClassrooms=this.classrooms:this.filteredClassrooms=this.classrooms.filter((e=>e.floor===this.selectedFloor))},setInitialFloorFromQuery(){const e=this.$route.query.floor;e&&this.floors.includes(e)?this.selectedFloor=e:this.selectedFloor="all",this.filterClassrooms()},updateFloorQuery(){this.filterClassrooms(),this.$router.replace({query:{...this.$route.query,floor:this.selectedFloor}})}},watch:{buildingId(e,t){e!==t&&(this.fetchClassrooms(),this.fetchBuildingName(),this.selectedFloor="all",this.filterClassrooms())}}};const _=(0,a.A)(X,[["render",S],["__scopeId","data-v-5b53ba6e"]]);var A=_,j={name:"ClassroomTableView",components:{ClassroomTable:A},props:{id:{type:String,required:!0}},computed:{buildingId(){return this.id}}};const P=(0,a.A)(j,[["render",x]]);var $=P;const q=[{path:"/",name:"BuildingList",component:E},{path:"/building/:id",name:"ClassroomTable",component:$,props:!0}],M=(0,c.aE)({history:(0,c.Bt)(),routes:q});var Q=M;(0,n.Ef)(d).use(Q).mount("#app")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,o),l.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,l){if(!n){var s=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],l=e[d][2];for(var i=!0,a=0;a<n.length;a++)(!1&l||s>=l)&&Object.keys(o.O).every((function(e){return o.O[e](n[a])}))?n.splice(a--,1):(i=!1,l<s&&(s=l));if(i){e.splice(d--,1);var u=r();void 0!==u&&(t=u)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[n,r,l]}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,l,s=n[0],i=n[1],a=n[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(a)var d=a(o)}for(t&&t(n);u<s.length;u++)l=s[u],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(d)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(4649)}));n=o.O(n)})();
//# sourceMappingURL=app.3b95203e.js.map